<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Kyoto Cabinet: Kyoto Cabinet: a straightforward implementation of DBM</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li class="current"><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Kyoto Cabinet: a straightforward implementation of DBM</h1><h2><a class="anchor" id="Introduction">
Introduction</a></h2>
<p>Kyoto Cabinet is a library of routines for managing a database. The database is a simple data file containing records, each is a pair of a key and a value. Every key and value is serial bytes with variable length. Both binary data and character string can be used as a key and a value. Each key must be unique within a database. There is neither concept of data tables nor data types. Records are organized in hash table or B+ tree.</p>
<p>The following access methods are provided to the database: storing a record with a key and a value, deleting a record by a key, retrieving a record by a key. Moreover, traversal access to every key are provided. These access methods are similar to ones of DBM (or its followers: NDBM and GDBM) library defined in the UNIX standard. Kyoto Cabinet is an alternative for DBM because of its higher performance.</p>
<p>Each operation of hash database has the time complexity of O(1). So, in theory, the performance is consant regardless of the scale of the database. In practice, the performance is determined by the speed of the main memory or the storage device. If the size of the database is less than the capacity of the main memory, the performance will seem on-memory speed which is fastar than std::map of STL. Of cource, the database size can be greater than the capacity of the main memory and the upper limit is 8 exabytes. Even in that case, each operation needs only one or two seeking of the storage device.</p>
<p>Each operation of B+ tree has the time complexity of O(log N). So, in theory, the performance is logarithmic about the scale of the database. Although the performance of random access of B+ tree is slower than that of hash database, B+ tree supports sequential access in order of the keys, which realizes forward matching search for strings and range search for integers. The performance of sequential access is much faster than that of random access.</p>
<p>As the API is based on object-oriented design, hash database and B+ tree database have same methods which inherited from the upper abstract class. Prototype database by containers of STL and cache database with LRU deletion algorithm are also provided under the same base class. All databases have practical utility methods related to transaction and cursor. Programs for command line interface are also included in the package.</p>
<p>The following classes are most important.</p>
<ul>
<li><a class="el" href="classkyotocabinet_1_1FileDB.html" title="Basic implementation for file database.">kyotocabinet::FileDB</a> -- common interface of concrete databases </li>
<li><a class="el" href="classkyotocabinet_1_1ProtoDB.html" title="Prototype implementation of file database with STL.">kyotocabinet::ProtoDB</a> -- prototype implementation of on-memory database with STL </li>
<li><a class="el" href="classkyotocabinet_1_1CacheDB.html" title="On-memory hash database with LRU deletion.">kyotocabinet::CacheDB</a> -- on-memory hash database for cache with LRU deletion </li>
<li><a class="el" href="classkyotocabinet_1_1HashDB.html" title="File hash database.">kyotocabinet::HashDB</a> -- file hash database </li>
<li><a class="el" href="classkyotocabinet_1_1TreeDB.html" title="File tree database.">kyotocabinet::TreeDB</a> -- file tree database</li>
</ul>
<p>See the project homepage ( <a href="http://1978th.net/kyotocabinet/">http://1978th.net/kyotocabinet/</a> ) for detail.</p>
<h2><a class="anchor" id="Example">
Example</a></h2>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &lt;kchashdb.h&gt;</span>

<span class="keyword">using namespace </span>std;
<span class="keyword">using namespace </span>kyotocabinet;

<span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv) {

  <span class="comment">// create the database object</span>
  HashDB db;

  <span class="comment">// open the database</span>
  <span class="keywordflow">if</span> (!db.open(<span class="stringliteral">&quot;casket.kch&quot;</span>, FileDB::OWRITER | FileDB::OCREATE)) {
    cout &lt;&lt; <span class="stringliteral">&quot;open error: &quot;</span> &lt;&lt; db.error().string() &lt;&lt; endl;
  }

  <span class="comment">// store records</span>
  <span class="keywordflow">if</span> (!db.set(<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;hop&quot;</span>) ||
     !db.set(<span class="stringliteral">&quot;bar&quot;</span>, <span class="stringliteral">&quot;step&quot;</span>) ||
     !db.set(<span class="stringliteral">&quot;baz&quot;</span>, <span class="stringliteral">&quot;jump&quot;</span>)) {
    cout &lt;&lt; <span class="stringliteral">&quot;set error: &quot;</span> &lt;&lt; db.error().string() &lt;&lt; endl;
  }

  <span class="comment">// retrieve records</span>
  <span class="keywordtype">string</span>* value = db.get(<span class="stringliteral">&quot;foo&quot;</span>);
  <span class="keywordflow">if</span> (value) {
    cout &lt;&lt; *value &lt;&lt; endl;
    <span class="keyword">delete</span> value;
  } <span class="keywordflow">else</span> {
    cout &lt;&lt; <span class="stringliteral">&quot;get error: &quot;</span> &lt;&lt; db.error().string() &lt;&lt; endl;
  }

  <span class="comment">// traverse records</span>
  <span class="keyword">class </span>Traverser : <span class="keyword">public</span> DB::Visitor {
    <span class="keyword">const</span> <span class="keywordtype">char</span>* visit_full(<span class="keyword">const</span> <span class="keywordtype">char</span>* kbuf, <span class="keywordtype">size_t</span> ksiz,
                           <span class="keyword">const</span> <span class="keywordtype">char</span>* vbuf, <span class="keywordtype">size_t</span> vsiz, <span class="keywordtype">size_t</span> *sp) {
      cout &lt;&lt; string(kbuf, ksiz) &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; string(vbuf, vsiz) &lt;&lt; endl;
      <span class="keywordflow">return</span> NOP;
    }
  } traverser;
  db.iterate(&amp;traverser, <span class="keyword">false</span>);

  <span class="comment">// close the database</span>
  <span class="keywordflow">if</span> (!db.close()) {
    cout &lt;&lt; <span class="stringliteral">&quot;close error: &quot;</span> &lt;&lt; db.error().string() &lt;&lt; endl;
  }

  <span class="keywordflow">return</span> 0;
}
</pre></div> </div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on Thu Feb 25 19:59:47 2010 for Kyoto Cabinet by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
